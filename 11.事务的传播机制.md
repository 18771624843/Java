#11.事务的传播机制

__事务的传播机制控制着事务的适用范围。__

下图说明了控制事务范围的重要性：Bean-1的method-A开启一个事务，然后调用Bean-2的method-B方法，当method-B执行时，需要启动一个新的事务或者采用method-A方法已有的事务，这取决于method-B的事务属性(Transaction Attributes)。

![事务的适用范围](http://docs.oracle.com/cd/E19226-01/820-7627/images/trans-transactionScope.gif)
 
## 事务属性

事务属性以及说明如下：

事务属性     |  说明
------------ | -------------
__Required__     | Required告诉容器，目标对象方法需要一个事务。如果事务上下文已经存在，容器则使用该事务，否则，容器将为此方法开启一个新事务。
__RequiresNew__  | 当对象方法被调用时，总是需要开启一个新的事务。如果先于方法调用前一个事务已经开启了，此事务将被暂时挂起，容器启动一个新的事务。当这个新事务随着方法调用完成终止后，老的事务将会继续。
__Mandatory__    | 当使用这个事务属性时，当方法被调用时，一个事先存在的事务上下文必须存在。如果此事务上下文不存在，容器将会抛出一个TransactionRequiredException，宣告它需要一个已存在的事务，但此事务没有找到。
__NotSupported__ | 告知容器，被调用的对象方法不使用事务。如果一个事务业已启动，容器会将此事务暂停直至方法调用结束。如果调用方法时没有事务存在，容器也不会为此方法开启任何事务。
__Supports__     | 告知容器，对象方法并不需要一个事务上下文，但当调用到这个方法而事务上下文碰巧存在时，该方法会使用它。
__Never__        | 告知容器，在调用对象方法时，不允许有事务上下文存在。要注意它和NOTSUPPORTED属性的区别。当使用NotSupported属性时，如果方法调用之前事务存在，容器会暂停此事务以执行方法，方法在没有事务上下文的环境下执行；而使用NEVER属性时，如果方法调用前事务存在，容器直接会抛出异常，告知您这个方法是决不能和事务有任何关系的。

## 参考资料

  * http://docs.oracle.com/cd/E19226-01/820-7627/6nisfjnao/index.html
  * 《Java事务设计策略》
